<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Painel Admin - Mercado Arapiraca</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    /* ======= VARIÁVEIS E ESTILOS GLOBAIS ======= */
    :root {
      --bg-light: #f8fafc; --text-light: #1e293b;
      --accent-light: #059669; --accent-light-hover: #047857;
      --secondary-light: #10b981; --secondary-light-hover: #059669;
      --focus-ring-light: #dc2626; --error-light: #dc2626; --success-light: #059669;
      --border-light: #e2e8f0; --shadow-light: rgba(0,0,0,.05);
      --input-bg-light: #fff; --input-text-light: #475569;
      --card-bg-light: #ffffff; --legend-text-light: #64748b;
      --step-bg-light: #f8fafc;
      --header-bg-light: linear-gradient(135deg, #059669 0%, #10b981 100%);

      --bg-dark: #0f172a; --text-dark: #f1f5f9;
      --accent-dark: #10b981; --accent-dark-hover: #059669;
      --secondary-dark: #34d399; --secondary-dark-hover: #10b981;
      --focus-ring-dark: #ef4444; --error-dark: #f87171; --success-dark: #34d399;
      --border-dark: #334155; --shadow-dark: rgba(255,255,255,.05);
      --input-bg-dark: #1e293b; --input-text-dark: #cbd5e1; 
      --card-bg-dark: #1e293b; --legend-text-dark: #94a3b8;
      --step-bg-dark: #1e293b;
      --header-bg-dark: linear-gradient(135deg, #047857 0%, #059669 100%);

      --bg: var(--bg-light); --text: var(--text-light); --accent: var(--accent-light);
      --accent-hover: var(--accent-light-hover); --focus-ring: var(--focus-ring-light);
      --error-color: var(--error-light); --success-color: var(--success-light);
      --border: var(--border-light); --shadow: var(--shadow-light);
      --input-bg: var(--input-bg-light); --input-text: var(--input-text-light);
      --card-bg: var(--card-bg-light); --legend-text: var(--legend-text-light);
      --step-bg: var(--step-bg-light);
      --header-bg: var(--header-bg-light);
      --transition-speed: .3s;
      --border-radius: 16px;
      --card-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
      --header-height: 180px;
    }
    
    [data-theme='dark'] {
      --bg: var(--bg-dark); --text: var(--text-dark); --accent: var(--accent-dark);
      --accent-hover: var(--accent-dark-hover); --focus-ring: var(--focus-ring-dark);
      --error-color: var(--error-dark); --success-color: var(--success-dark);
      --border: var(--border-dark); --shadow: var(--shadow-dark);
      --input-bg: var(--input-bg-dark); --input-text: var(--input-text-dark);
      --card-bg: var(--card-bg-dark); --legend-text: var(--legend-text-dark);
      --step-bg: var(--step-bg-dark);
      --header-bg: var(--header-bg-dark);
      --card-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }
    
    * { 
      box-sizing: border-box; 
      margin: 0; 
      padding: 0;
    }
    
    body {
      font-family: Inter, system-ui, Segoe UI, Roboto, Arial, sans-serif;
      background: var(--bg); 
      color: var(--text); 
      line-height: 1.6;
      transition: background-color var(--transition-speed), color var(--transition-speed);
      padding: 0;
      min-height: 100vh;
    }
    
    .app-container {
      width: 100%;
      max-width: 1400px;
      margin: 0 auto;
      position: relative;
    }
    
    .header {
      background: var(--header-bg);
      color: white;
      padding: 2rem 2rem 1.5rem;
      border-radius: 0 0 var(--border-radius) var(--border-radius);
      text-align: center;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      position: relative;
      overflow: hidden;
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.3;
    }
    
    .header-content {
      position: relative;
      z-index: 1;
    }
    
    h1 {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      letter-spacing: -0.5px;
    }
    
    .header-subtitle {
      font-size: 1rem;
      opacity: 0.9;
      margin-bottom: 1.5rem;
      font-weight: 400;
    }
    
    .theme-toggle {
      position: absolute;
      top: 1.5rem;
      right: 1.5rem;
      background: rgba(255, 255, 255, 0.2);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      z-index: 10;
    }
    
    .theme-toggle:hover {
      background: rgba(255, 255, 255, 0.3);
      transform: rotate(30deg);
    }
    
    /* ====== NAVEGAÇÃO POR ABAS ====== */
    .tabs-container {
      background: var(--card-bg);
      margin: 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      overflow: hidden;
    }
    
    .tabs-header {
      display: flex;
      border-bottom: 1px solid var(--border);
      background: var(--card-bg);
    }
    
    .tab {
      padding: 1.2rem 1.5rem;
      cursor: pointer;
      transition: all var(--transition-speed);
      border-bottom: 3px solid transparent;
      font-weight: 600;
      color: var(--legend-text);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .tab.active {
      border-bottom: 3px solid var(--accent);
      color: var(--accent);
      background: color-mix(in srgb, var(--accent) 5%, transparent);
    }
    
    .tab:hover:not(.active) {
      background: color-mix(in srgb, var(--accent) 2%, transparent);
      color: var(--text);
    }
    
    .tab-content {
      display: none;
      padding: 2rem;
      animation: fadeInUp .5s ease-out;
    }
    
    .tab-content.active {
      display: block;
    }
    
    /* ====== CARDS E MÉTRICAS ====== */
    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .metric-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      box-shadow: var(--card-shadow);
      border-left: 4px solid var(--accent);
      transition: all var(--transition-speed);
      position: relative;
      overflow: hidden;
    }
    
    .metric-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--accent), var(--accent-hover));
    }
    
    .metric-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }
    
    .metric-card h3 {
      font-size: 0.9rem;
      color: var(--legend-text);
      margin-bottom: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 600;
    }
    
    .metric-card .value {
      font-size: 2rem;
      font-weight: 700;
      color: var(--text);
      margin-bottom: 0.25rem;
    }
    
    .metric-card .description {
      font-size: 0.85rem;
      color: var(--legend-text);
    }
    
    /* ====== GRÁFICOS ====== */
    .charts-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .chart-card {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      box-shadow: var(--card-shadow);
      transition: all var(--transition-speed);
    }
    
    .chart-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }
    
    .chart-card h3 {
      margin-bottom: 1rem;
      color: var(--text);
      font-weight: 600;
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .chart-card h3 i {
      color: var(--accent);
    }
    
    /* ====== TABELAS ====== */
    .table-container {
      background: var(--card-bg);
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: var(--card-shadow);
      margin-bottom: 2rem;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
    }
    
    thead {
      background: linear-gradient(90deg, var(--accent), var(--accent-hover));
      color: white;
    }
    
    th, td {
      padding: 1rem 1.2rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    
    tbody tr {
      transition: background-color var(--transition-speed);
    }
    
    tbody tr:hover {
      background: color-mix(in srgb, var(--accent) 5%, transparent);
    }
    
    /* ====== FILTROS ====== */
    .filters-panel {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--card-shadow);
      margin-bottom: 1.5rem;
    }
    
    .filters-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .filter-group {
      display: flex;
      flex-direction: column;
    }
    
    .filter-group label {
      margin-bottom: 0.5rem;
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text);
    }
    
    .filter-select, .filter-input {
      padding: 0.8rem 1rem;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--input-bg);
      color: var(--input-text);
      font-size: 0.9rem;
      transition: all var(--transition-speed);
      outline: none;
    }
    
    .filter-select:focus, .filter-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px color-mix(in srgb, var(--accent) 20%, transparent);
    }
    
    .filter-actions {
      display: flex;
      gap: 1rem;
      justify-content: flex-end;
      align-items: center;
      margin-top: 1rem;
    }
    
    /* ====== BOTÕES ====== */
    .btn {
      padding: 0.8rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all var(--transition-speed);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn-primary {
      background: var(--accent);
      color: white;
    }
    
    .btn-primary:hover {
      background: var(--accent-hover);
      transform: translateY(-2px);
    }
    
    .btn-danger {
      background: var(--error-color);
      color: white;
    }
    
    .btn-danger:hover {
      background: color-mix(in srgb, var(--error-color) 80%, black);
      transform: translateY(-2px);
    }
    
    .btn-secondary {
      background: var(--border);
      color: var(--text);
    }
    
    .btn-secondary:hover {
      background: color-mix(in srgb, var(--border) 80%, black);
      transform: translateY(-2px);
    }
    
    .action-btn {
      padding: 0.5rem 0.8rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: all var(--transition-speed);
      margin: 0 0.2rem;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
    }
    
    .action-btn.view {
      background: var(--accent);
      color: white;
    }
    
    .action-btn.edit {
      background: var(--secondary-light);
      color: white;
    }
    
    .action-btn.delete {
      background: var(--error-color);
      color: white;
    }
    
    .action-btn.distance {
      background: #8b5cf6;
      color: white;
    }
    
    .action-btn:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }
    
    /* ====== BADGES ====== */
    .badge {
      padding: 0.4rem 0.8rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 600;
    }
    
    .badge-success {
      background: color-mix(in srgb, var(--success-color) 15%, transparent);
      color: var(--success-color);
      border: 1px solid color-mix(in srgb, var(--success-color) 30%, transparent);
    }
    
    .badge-warning {
      background: color-mix(in srgb, var(--warning) 15%, transparent);
      color: var(--warning);
      border: 1px solid color-mix(in srgb, var(--warning) 30%, transparent);
    }
    
    .badge-primary {
      background: color-mix(in srgb, var(--accent) 15%, transparent);
      color: var(--accent);
      border: 1px solid color-mix(in srgb, var(--accent) 30%, transparent);
    }
    
    /* ====== MODAIS ====== */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .modal-content {
      background: var(--card-bg);
      padding: 2rem;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--card-shadow);
      position: relative;
    }
    
    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--legend-text);
    }
    
    .modal-header {
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }
    
    .modal-header h2 {
      color: var(--text);
      font-size: 1.5rem;
    }
    
    /* ====== ANIMAÇÕES ====== */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    /* ====== RESPONSIVIDADE ====== */
    @media (max-width: 1200px) {
      .app-container { max-width: 100%; padding: 0 1rem; }
    }
    
    @media (max-width: 992px) {
      .charts-grid { grid-template-columns: 1fr; }
      .filters-grid { grid-template-columns: repeat(2, 1fr); }
    }
    
    @media (max-width: 768px) {
      .header { padding: 1.5rem 1.5rem 1rem; }
      h1 { font-size: 1.5rem; }
      .header-subtitle { font-size: 0.9rem; }
      .tabs-container { margin: 1rem; }
      .tab { padding: 1rem; font-size: 0.9rem; }
      .tab-content { padding: 1.5rem; }
      .metrics-grid { grid-template-columns: 1fr; }
      .filters-grid { grid-template-columns: 1fr; }
      .filter-actions { flex-direction: column; }
      .theme-toggle { top: 1rem; right: 1rem; width: 36px; height: 36px; }
    }
    
    @media (max-width: 576px) {
      .header { padding: 1.25rem 1rem 0.75rem; }
      h1 { font-size: 1.3rem; }
      .header-subtitle { font-size: 0.85rem; }
      .tabs-header { flex-direction: column; }
      .tab { padding: 0.8rem; justify-content: center; }
      .chart-card { padding: 1rem; }
      th, td { padding: 0.8rem; }
    }
  </style>
</head>
<body data-theme="light">
  <div class="app-container">
    <div class="header">
      <button class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
      </button>
      
      <div class="header-content">
        <h1>Painel Administrativo - Mercado Arapiraca</h1>
        <p class="header-subtitle">Gerencie candidaturas, vagas e visualize métricas importantes</p>
      </div>
    </div>

    <div class="tabs-container">
      <div class="tabs-header">
        <div class="tab active" data-tab="dashboard">
          <i class="fas fa-chart-line"></i>
          Dashboard Interativo
        </div>
        <div class="tab" data-tab="curriculos">
          <i class="fas fa-file-alt"></i>
          Análise de Currículos
        </div>
        <div class="tab" data-tab="vagas">
          <i class="fas fa-list-ul"></i>
          Gerenciamento de Vagas
        </div>
      </div>

      <!-- DASHBOARD INTERATIVO -->
      <div id="dashboard" class="tab-content active">
        <div class="metrics-grid">
          <div class="metric-card">
            <h3>Total de Candidaturas</h3>
            <div class="value" id="total-candidaturas">0</div>
            <div class="description">Candidaturas recebidas</div>
          </div>
          <div class="metric-card">
            <h3>Vaga Mais Popular</h3>
            <div class="value" id="vaga-popular">-</div>
            <div class="description" id="count-vaga-popular">0 candidaturas</div>
          </div>
          <div class="metric-card">
            <h3>Candidatos de Arapiraca</h3>
            <div class="value" id="candidatos-arapiraca">0</div>
            <div class="description" id="percentual-arapiraca">0% do total</div>
          </div>
          <div class="metric-card">
            <h3>Taxa com Transporte</h3>
            <div class="value" id="taxa-transporte">0%</div>
            <div class="description">Possuem veículo próprio</div>
          </div>
        </div>

        <div class="charts-grid">
          <div class="chart-card">
            <h3><i class="fas fa-chart-bar"></i> Candidaturas por Vaga</h3>
            <canvas id="chart-vagas"></canvas>
          </div>
          <div class="chart-card">
            <h3><i class="fas fa-map-marker-alt"></i> Distribuição por Cidade</h3>
            <canvas id="chart-cidades"></canvas>
          </div>
        </div>

        <div class="charts-grid">
          <div class="chart-card">
            <h3><i class="fas fa-chart-line"></i> Evolução dos Últimos 7 Dias</h3>
            <canvas id="chart-evolucao"></canvas>
          </div>
          <div class="chart-card">
            <h3><i class="fas fa-car"></i> Status de Transporte</h3>
            <canvas id="chart-transporte"></canvas>
          </div>
        </div>
      </div>

      <!-- ANÁLISE DE CURRÍCULOS -->
      <div id="curriculos" class="tab-content">
        <div class="filters-panel">
          <div class="filters-grid">
            <div class="filter-group">
              <label for="filter-vaga">Vaga</label>
              <select id="filter-vaga" class="filter-select">
                <option value="todas">Todas as vagas</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-cidade">Cidade</label>
              <select id="filter-cidade" class="filter-select">
                <option value="todas">Todas as cidades</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-transporte">Transporte</label>
              <select id="filter-transporte" class="filter-select">
                <option value="todos">Todos</option>
                <option value="Sim">Com transporte</option>
                <option value="Não">Sem transporte</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-periodo">Período</label>
              <select id="filter-periodo" class="filter-select">
                <option value="todos">Todos os períodos</option>
                <option value="7">Últimos 7 dias</option>
                <option value="30">Últimos 30 dias</option>
                <option value="90">Últimos 3 meses</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="filter-distancia">Distância</label>
              <select id="filter-distancia" class="filter-select">
                <option value="todas">Todas as distâncias</option>
                <option value="proximos">Mais próximos</option>
                <option value="distantes">Mais distantes</option>
              </select>
            </div>
          </div>
          <div class="filter-actions">
            <div class="filter-group" style="flex: 1;">
              <label for="filter-search">Buscar (Nome, CPF ou Telefone)</label>
              <input type="text" id="filter-search" class="filter-input" placeholder="Digite para buscar...">
            </div>
            <button class="btn btn-primary" id="aplicar-filtros">
              <i class="fas fa-filter"></i> Aplicar Filtros
            </button>
            <button class="btn btn-secondary" id="limpar-filtros">
              <i class="fas fa-eraser"></i> Limpar
            </button>
          </div>
        </div>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Nome</th>
                <th>Vaga</th>
                <th>Cidade</th>
                <th>Bairro</th>
                <th>Transporte</th>
                <th>Data</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="corpo-tabela">
              <tr>
                <td colspan="7" style="text-align: center; padding: 2rem;">
                  <i class="fas fa-spinner fa-spin"></i> Carregando dados...
                </td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="filter-actions">
          <div id="pagination-info" style="color: var(--legend-text); font-size: 0.9rem;">
            Mostrando 0 de 0 registros
          </div>
          <div id="pagination">
            <!-- Paginação será gerada aqui -->
          </div>
        </div>
      </div>

      <!-- GERENCIAMENTO DE VAGAS -->
      <div id="vagas" class="tab-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem;">
          <h2 style="color: var(--text);">Gerenciamento de Vagas</h2>
          <button class="btn btn-primary" id="add-vaga-btn">
            <i class="fas fa-plus"></i> Nova Vaga
          </button>
        </div>

        <div class="table-container">
          <table>
            <thead>
              <tr>
                <th>Nome da Vaga</th>
                <th>Status</th>
                <th>Candidaturas</th>
                <th>Ações</th>
              </tr>
            </thead>
            <tbody id="tabela-vagas">
              <tr>
                <td colspan="4" style="text-align: center; padding: 2rem;">
                  <i class="fas fa-spinner fa-spin"></i> Carregando vagas...
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- MODAL DE DETALHES DO CANDIDATO -->
  <div id="candidato-modal" class="modal">
    <div class="modal-content">
      <button class="modal-close" id="close-modal">&times;</button>
      <div class="modal-header">
        <h2>Detalhes do Candidato</h2>
      </div>
      <div id="candidato-info">
        <!-- Informações serão preenchidas via JavaScript -->
      </div>
    </div>
  </div>

  <!-- MODAL DE NOVA VAGA -->
  <div id="vaga-modal" class="modal">
    <div class="modal-content" style="max-width: 500px;">
      <button class="modal-close" id="close-vaga-modal">&times;</button>
      <div class="modal-header">
        <h2 id="vaga-modal-title">Nova Vaga</h2>
      </div>
      <div style="display: flex; flex-direction: column; gap: 1.5rem;">
        <div class="filter-group">
          <label for="vaga-nome">Nome da Vaga</label>
          <input type="text" id="vaga-nome" class="filter-input" placeholder="Ex: Caixa">
        </div>
        <div class="filter-group">
          <label for="vaga-status">Status</label>
          <select id="vaga-status" class="filter-select">
            <option value="true">Ativa</option>
            <option value="false">Inativa</option>
          </select>
        </div>
        <button class="btn btn-primary" id="salvar-vaga-btn">Salvar Vaga</button>
      </div>
    </div>
  </div>

  <!-- MODAL DE DISTÂNCIA -->
  <div id="distancia-modal" class="modal">
    <div class="modal-content" style="max-width: 600px;">
      <button class="modal-close" id="close-distancia-modal">&times;</button>
      <div class="modal-header">
        <h2><i class="fas fa-route"></i> Calculadora de Distância</h2>
      </div>
      <div id="distancia-content">
        <!-- Conteúdo será preenchido via JavaScript -->
      </div>
    </div>
  </div>

  <script>
    // ====== CONFIGURAÇÕES ======
    const API_BASE = "https://formulariobk.onrender.com";
    const ADMIN_TOKEN = "admin-secret-token";
    let currentPage = 1;
    const itemsPerPage = 10;
    let currentFilters = {};
    let editingVagaId = null;

    // ====== ELEMENTOS DA DOM ======
    const themeToggle = document.getElementById('themeToggle');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');

    // ====== TOGGLE DE TEMA ======
    themeToggle.addEventListener('click', () => {
      const currentTheme = document.body.getAttribute('data-theme');
      const newTheme = currentTheme === 'light' ? 'dark' : 'light';
      document.body.setAttribute('data-theme', newTheme);
      
      // Atualizar ícone do botão
      const icon = themeToggle.querySelector('i');
      if (newTheme === 'dark') {
        icon.classList.remove('fa-moon');
        icon.classList.add('fa-sun');
      } else {
        icon.classList.remove('fa-sun');
        icon.classList.add('fa-moon');
      }
      
      // Salvar preferência
      localStorage.setItem('theme', newTheme);
    });

    // Carregar tema salvo
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.body.setAttribute('data-theme', savedTheme);
    if (savedTheme === 'dark') {
      themeToggle.querySelector('i').classList.remove('fa-moon');
      themeToggle.querySelector('i').classList.add('fa-sun');
    }

    // ====== NAVEGAÇÃO POR ABAS ======
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const tabId = tab.getAttribute('data-tab');
        
        // Atualizar abas ativas
        tabs.forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        
        // Atualizar conteúdo das abas
        tabContents.forEach(content => {
          content.classList.remove('active');
          if (content.id === tabId) {
            content.classList.add('active');
            
            // Carregar dados específicos da aba
            if (tabId === 'dashboard') {
              loadDashboard();
            } else if (tabId === 'curriculos') {
              loadCurriculos();
            } else if (tabId === 'vagas') {
              loadVagas();
            }
          }
        });
      });
    });

    // ====== FUNÇÕES DE API ======
    async function apiCall(endpoint, options = {}) {
      try {
        const response = await fetch(`${API_BASE}${endpoint}`, {
          ...options,
          headers: {
            'Authorization': `Bearer ${ADMIN_TOKEN}`,
            'Content-Type': 'application/json',
            ...options.headers
          }
        });

        if (!response.ok) {
          throw new Error(`Erro ${response.status}: ${response.statusText}`);
        }

        return response.json();
      } catch (error) {
        console.error('Erro na chamada da API:', error);
        throw error;
      }
    }

    // ====== DASHBOARD ======
    async function loadDashboard() {
      try {
        const stats = await apiCall('/api/admin/stats');

        // Atualizar cards
        document.getElementById('total-candidaturas').textContent = stats.total.toLocaleString();
        
        if (stats.porVaga.length > 0) {
          const vagaPopular = stats.porVaga[0];
          document.getElementById('vaga-popular').textContent = 
            vagaPopular.vaga.length > 15 ? vagaPopular.vaga.substring(0, 15) + '...' : vagaPopular.vaga;
          document.getElementById('count-vaga-popular').textContent = `${vagaPopular.count} candidaturas`;
        }
        
        document.getElementById('candidatos-arapiraca').textContent = stats.arapiraca.toLocaleString();
        const percentualArapiraca = stats.total > 0 ? Math.round((stats.arapiraca / stats.total) * 100) : 0;
        document.getElementById('percentual-arapiraca').textContent = `${percentualArapiraca}% do total`;

        // Calcular taxa de transporte
        const totalTransporte = stats.porTransporte.reduce((acc, item) => acc + item.count, 0);
        const comTransporte = stats.porTransporte.find(item => item.transporte === 'Sim')?.count || 0;
        const taxaTransporte = totalTransporte > 0 ? Math.round((comTransporte / totalTransporte) * 100) : 0;
        document.getElementById('taxa-transporte').textContent = `${taxaTransporte}%`;

        // Renderizar gráficos
        renderCharts(stats);

      } catch (error) {
        console.error('Erro ao carregar dashboard:', error);
        alert('Erro ao carregar dashboard: ' + error.message);
      }
    }

    function renderCharts(stats) {
      // Gráfico de candidaturas por vaga
      const ctxVagas = document.getElementById('chart-vagas').getContext('2d');
      new Chart(ctxVagas, {
        type: 'bar',
        data: {
          labels: stats.porVaga.slice(0, 8).map(item => 
            item.vaga.length > 12 ? item.vaga.substring(0, 12) + '...' : item.vaga
          ),
          datasets: [{
            label: 'Candidaturas',
            data: stats.porVaga.slice(0, 8).map(item => item.count),
            backgroundColor: '#059669',
            borderColor: '#047857',
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

      // Gráfico de distribuição por cidade
      const ctxCidades = document.getElementById('chart-cidades').getContext('2d');
      new Chart(ctxCidades, {
        type: 'doughnut',
        data: {
          labels: stats.porCidade.slice(0, 6).map(item => item.cidade),
          datasets: [{
            data: stats.porCidade.slice(0, 6).map(item => item.count),
            backgroundColor: [
              '#059669', '#10b981', '#34d399', '#065f46', '#047857', '#a7f3d0'
            ]
          }]
        }
      });

      // Gráfico de evolução
      const ctxEvolucao = document.getElementById('chart-evolucao').getContext('2d');
      new Chart(ctxEvolucao, {
        type: 'line',
        data: {
          labels: stats.evolucao.map(item => item.data.split('/')[0]),
          datasets: [{
            label: 'Candidaturas',
            data: stats.evolucao.map(item => item.count),
            backgroundColor: 'rgba(5, 150, 105, 0.2)',
            borderColor: '#059669',
            borderWidth: 3,
            tension: 0.4,
            fill: true
          }]
        },
        options: {
          responsive: true,
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

      // Gráfico de transporte
      const ctxTransporte = document.getElementById('chart-transporte').getContext('2d');
      new Chart(ctxTransporte, {
        type: 'pie',
        data: {
          labels: stats.porTransporte.map(item => item.transporte),
          datasets: [{
            data: stats.porTransporte.map(item => item.count),
            backgroundColor: ['#059669', '#ef4444']
          }]
        }
      });
    }

    // ====== ANÁLISE DE CURRÍCULOS ======
    async function loadCurriculos(page = 1) {
      try {
        showLoading('curriculos');
        
        const params = new URLSearchParams({
          page: page,
          limit: itemsPerPage,
          ...currentFilters
        });

        const data = await apiCall(`/api/admin/candidaturas?${params}`);
        displayCurriculos(data.candidaturas);
        setupPagination(data.total, data.page, data.totalPages);
        
        // Carregar filtros se for a primeira vez
        if (page === 1) {
          await loadFiltros();
        }

      } catch (error) {
        console.error('Erro ao carregar currículos:', error);
        showError('curriculos', 'Erro ao carregar currículos: ' + error.message);
      }
    }

    async function loadFiltros() {
      try {
        const filtros = await apiCall('/api/admin/filtros');
        
        // Preencher filtro de vagas
        const filterVaga = document.getElementById('filter-vaga');
        filtros.vagas.forEach(vaga => {
          const option = new Option(vaga, vaga);
          filterVaga.add(option);
        });

        // Preencher filtro de cidades
        const filterCidade = document.getElementById('filter-cidade');
        filtros.cidades.forEach(cidade => {
          const option = new Option(cidade, cidade);
          filterCidade.add(option);
        });

      } catch (error) {
        console.error('Erro ao carregar filtros:', error);
      }
    }

    function displayCurriculos(curriculos) {
      const corpoTabela = document.getElementById('corpo-tabela');
      
      if (curriculos.length === 0) {
        corpoTabela.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 2rem; color: var(--legend-text);">
              <i class="fas fa-inbox" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
              Nenhuma candidatura encontrada com os filtros aplicados.
            </td>
          </tr>
        `;
        return;
      }

      corpoTabela.innerHTML = curriculos.map(curriculo => `
        <tr>
          <td><strong>${curriculo.nome}</strong></td>
          <td>${curriculo.vaga}</td>
          <td>${curriculo.cidade}</td>
          <td>${curriculo.bairro}</td>
          <td><span class="badge ${curriculo.transporte === 'Sim' ? 'badge-success' : 'badge-warning'}">${curriculo.transporte}</span></td>
          <td>${formatarData(curriculo.enviado_em)}</td>
          <td>
            <button class="action-btn view" onclick="visualizarCandidato(${curriculo.id})" title="Ver detalhes">
              <i class="fas fa-eye"></i>
            </button>
            <button class="action-btn distance" onclick="calcularDistanciaCandidato(${curriculo.id})" title="Calcular distância">
              <i class="fas fa-route"></i>
            </button>
            <button class="action-btn delete" onclick="excluirCandidatura(${curriculo.id})" title="Excluir candidatura">
              <i class="fas fa-trash"></i>
            </button>
          </td>
        </tr>
      `).join('');
    }

    function setupPagination(total, currentPage, totalPages) {
      const pagination = document.getElementById('pagination');
      const paginationInfo = document.getElementById('pagination-info');
      
      paginationInfo.textContent = `Mostrando ${total} registros`;
      
      if (totalPages <= 1) {
        pagination.innerHTML = '';
        return;
      }

      let html = '';
      
      // Botão anterior
      html += `<button class="btn btn-secondary" ${currentPage === 1 ? 'disabled' : ''} onclick="loadCurriculos(${currentPage - 1})">
        <i class="fas fa-chevron-left"></i> Anterior
      </button>`;
      
      // Páginas
      for (let i = 1; i <= totalPages; i++) {
        if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
          html += `<button class="btn ${i === currentPage ? 'btn-primary' : 'btn-secondary'}" onclick="loadCurriculos(${i})">${i}</button>`;
        } else if (i === currentPage - 3 || i === currentPage + 3) {
          html += `<span style="padding: 0.8rem 1rem;">...</span>`;
        }
      }
      
      // Botão próximo
      html += `<button class="btn btn-secondary" ${currentPage === totalPages ? 'disabled' : ''} onclick="loadCurriculos(${currentPage + 1})">
        Próximo <i class="fas fa-chevron-right"></i>
      </button>`;
      
      pagination.innerHTML = html;
    }

    // Aplicar filtros
    document.getElementById('aplicar-filtros').addEventListener('click', () => {
      currentFilters = {
        vaga: document.getElementById('filter-vaga').value !== 'todas' ? document.getElementById('filter-vaga').value : undefined,
        cidade: document.getElementById('filter-cidade').value !== 'todas' ? document.getElementById('filter-cidade').value : undefined,
        transporte: document.getElementById('filter-transporte').value !== 'todos' ? document.getElementById('filter-transporte').value : undefined,
        search: document.getElementById('filter-search').value || undefined
      };
      
      // Remover valores undefined
      Object.keys(currentFilters).forEach(key => {
        if (currentFilters[key] === undefined) {
          delete currentFilters[key];
        }
      });
      
      loadCurriculos(1);
    });

    // Limpar filtros
    document.getElementById('limpar-filtros').addEventListener('click', () => {
      document.getElementById('filter-vaga').value = 'todas';
      document.getElementById('filter-cidade').value = 'todas';
      document.getElementById('filter-transporte').value = 'todos';
      document.getElementById('filter-periodo').value = 'todos';
      document.getElementById('filter-distancia').value = 'todas';
      document.getElementById('filter-search').value = '';
      
      currentFilters = {};
      loadCurriculos(1);
    });

    // ====== GERENCIAMENTO DE VAGAS ======
    async function loadVagas() {
      try {
        const vagas = await apiCall('/api/admin/vagas');
        const tabela = document.getElementById('tabela-vagas');

        if (vagas.length === 0) {
          tabela.innerHTML = `
            <tr>
              <td colspan="4" style="text-align: center; padding: 2rem; color: var(--legend-text);">
                <i class="fas fa-list" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
                Nenhuma vaga cadastrada.
              </td>
            </tr>
          `;
          return;
        }

        tabela.innerHTML = vagas.map(vaga => `
          <tr>
            <td><strong>${vaga.nome}</strong></td>
            <td>
              <span class="badge ${vaga.ativa ? 'badge-success' : 'badge-warning'}">
                ${vaga.ativa ? 'Ativa' : 'Inativa'}
              </span>
            </td>
            <td>-</td>
            <td>
              <button class="action-btn edit" onclick="editarVaga(${vaga.id}, '${vaga.nome}', ${vaga.ativa})" title="Editar">
                <i class="fas fa-edit"></i>
              </button>
              <button class="action-btn delete" onclick="excluirVaga(${vaga.id})" title="Excluir">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          </tr>
        `).join('');

      } catch (error) {
        console.error('Erro ao carregar vagas:', error);
        showError('vagas', 'Erro ao carregar vagas: ' + error.message);
      }
    }

    // Abrir modal de nova vaga
    document.getElementById('add-vaga-btn').addEventListener('click', () => {
      editingVagaId = null;
      document.getElementById('vaga-modal-title').textContent = 'Nova Vaga';
      document.getElementById('vaga-nome').value = '';
      document.getElementById('vaga-status').value = 'true';
      document.getElementById('vaga-modal').style.display = 'flex';
    });

    // Editar vaga
    function editarVaga(id, nome, ativa) {
      editingVagaId = id;
      document.getElementById('vaga-modal-title').textContent = 'Editar Vaga';
      document.getElementById('vaga-nome').value = nome;
      document.getElementById('vaga-status').value = ativa.toString();
      document.getElementById('vaga-modal').style.display = 'flex';
    }

    // Salvar vaga
    document.getElementById('salvar-vaga-btn').addEventListener('click', async () => {
      const nome = document.getElementById('vaga-nome').value;
      const ativa = document.getElementById('vaga-status').value === 'true';

      if (!nome) {
        alert('Nome da vaga é obrigatório.');
        return;
      }

      try {
        if (editingVagaId) {
          await apiCall(`/api/admin/vagas/${editingVagaId}`, {
            method: 'PUT',
            body: JSON.stringify({ nome, ativa })
          });
        } else {
          await apiCall('/api/admin/vagas', {
            method: 'POST',
            body: JSON.stringify({ nome, ativa })
          });
        }

        document.getElementById('vaga-modal').style.display = 'none';
        loadVagas();
        alert('Vaga salva com sucesso!');

      } catch (error) {
        console.error('Erro ao salvar vaga:', error);
        alert('Erro ao salvar vaga: ' + error.message);
      }
    });

    // Excluir vaga
    async function excluirVaga(id) {
      if (!confirm('Tem certeza que deseja excluir esta vaga? Esta ação não pode ser desfeita.')) {
        return;
      }

      try {
        await apiCall(`/api/admin/vagas/${id}`, { method: 'DELETE' });
        alert('Vaga excluída com sucesso.');
        loadVagas();
      } catch (error) {
        console.error('Erro ao excluir vaga:', error);
        alert('Erro ao excluir vaga: ' + error.message);
      }
    }

    // ====== FUNÇÕES AUXILIARES ======
    function showLoading(tabId) {
      const tabContent = document.getElementById(tabId);
      if (tabId === 'curriculos') {
        document.getElementById('corpo-tabela').innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 2rem;">
              <i class="fas fa-spinner fa-spin"></i> Carregando dados...
            </td>
          </tr>
        `;
      }
    }

    function showError(tabId, message) {
      const tabContent = document.getElementById(tabId);
      if (tabId === 'curriculos') {
        document.getElementById('corpo-tabela').innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; padding: 2rem; color: var(--error-color);">
              <i class="fas fa-exclamation-triangle" style="font-size: 2rem; margin-bottom: 1rem; display: block;"></i>
              ${message}
            </td>
          </tr>
        `;
      }
    }

    function formatarData(dataString) {
      const data = new Date(dataString);
      return data.toLocaleDateString('pt-BR') + ' ' + data.toLocaleTimeString('pt-BR', { 
        hour: '2-digit', 
        minute: '2-digit' 
      });
    }

    // ====== FUNÇÕES DOS MODAIS ======
    async function visualizarCandidato(id) {
      try {
        const candidato = await apiCall(`/api/admin/candidaturas/${id}`);
        const modal = document.getElementById('candidato-modal');
        const info = document.getElementById('candidato-info');

        info.innerHTML = `
          <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
            <div>
              <h3 style="color: var(--text); margin-bottom: 1rem;">Informações Pessoais</h3>
              <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                <div><strong>Nome:</strong> ${candidato.nome}</div>
                <div><strong>CPF:</strong> ${candidato.cpf}</div>
                <div><strong>Email:</strong> ${candidato.email}</div>
                <div><strong>Telefone:</strong> ${candidato.telefone}</div>
              </div>
            </div>
            <div>
              <h3 style="color: var(--text); margin-bottom: 1rem;">Endereço</h3>
              <div style="display: flex; flex-direction: column; gap: 0.8rem;">
                <div><strong>CEP:</strong> ${candidato.cep}</div>
                <div><strong>Cidade:</strong> ${candidato.cidade}</div>
                <div><strong>Bairro:</strong> ${candidato.bairro}</div>
                <div><strong>Rua:</strong> ${candidato.rua}</div>
                <div><strong>Transporte:</strong> <span class="badge ${candidato.transporte === 'Sim' ? 'badge-success' : 'badge-warning'}">${candidato.transporte}</span></div>
              </div>
            </div>
          </div>
          
          <div style="margin-bottom: 1.5rem;">
            <h3 style="color: var(--text); margin-bottom: 1rem;">Candidatura</h3>
            <div style="display: flex; flex-direction: column; gap: 0.8rem;">
              <div><strong>Vaga:</strong> ${candidato.vaga}</div>
              <div><strong>Data de Envio:</strong> ${formatarData(candidato.enviado_em)}</div>
            </div>
          </div>

          <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
            <button class="btn btn-primary" onclick="calcularDistanciaCandidato(${candidato.id})">
              <i class="fas fa-route"></i> Calcular Distância
            </button>
          </div>
        `;

        modal.style.display = 'flex';
      } catch (error) {
        console.error('Erro ao carregar candidato:', error);
        alert('Erro ao carregar informações do candidato: ' + error.message);
      }
    }

    async function calcularDistanciaCandidato(id) {
      try {
        const candidato = await apiCall(`/api/admin/candidaturas/${id}`);
        const enderecoCandidato = `${candidato.rua}, ${candidato.bairro}, ${candidato.cidade}`;
        
        const resultado = await apiCall('/api/admin/calcular-distancia', {
          method: 'POST',
          body: JSON.stringify({
            enderecoCandidato: enderecoCandidato
          })
        });

        const modal = document.getElementById('distancia-modal');
        const content = document.getElementById('distancia-content');

        content.innerHTML = `
          <div style="text-align: center;">
            <h3 style="color: var(--accent); margin-bottom: 1.5rem;">
              <i class="fas fa-route"></i> Distância do Candidato
            </h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem;">
              <div style="background: var(--step-bg); padding: 1.5rem; border-radius: 10px;">
                <div style="font-size: 0.9rem; color: var(--legend-text); margin-bottom: 0.5rem;">Distância</div>
                <div style="font-size: 2rem; font-weight: 700; color: var(--accent);">${resultado.distancia}</div>
              </div>
              <div style="background: var(--step-bg); padding: 1.5rem; border-radius: 10px;">
                <div style="font-size: 0.9rem; color: var(--legend-text); margin-bottom: 0.5rem;">Tempo Estimado</div>
                <div style="font-size: 2rem; font-weight: 700; color: var(--accent);">${resultado.duracao}</div>
              </div>
            </div>
            
            <div style="background: var(--step-bg); padding: 1.5rem; border-radius: 10px; border: 1px solid var(--border); margin-bottom: 1rem;">
              <div style="font-weight: 600; margin-bottom: 0.8rem; color: var(--text);">
                <i class="fas fa-store"></i> Local do Mercado
              </div>
              <div style="color: var(--text);">Km 91, AL-220, 948 - Sen. Arnon de Melo, Arapiraca - AL</div>
            </div>
            
            <div style="background: var(--step-bg); padding: 1.5rem; border-radius: 10px; border: 1px solid var(--border);">
              <div style="font-weight: 600; margin-bottom: 0.8rem; color: var(--text);">
                <i class="fas fa-user"></i> Endereço do Candidato
              </div>
              <div style="color: var(--text);">${enderecoCandidato}</div>
            </div>
            
            <div style="margin-top: 1.5rem; padding: 1rem; background: color-mix(in srgb, var(--success-color) 15%, transparent); border-radius: 10px;">
              <div style="font-size: 0.9rem; color: var(--success-color);">
                <i class="fas fa-info-circle"></i> ${resultado.observacao}
              </div>
            </div>
          </div>
        `;

        modal.style.display = 'flex';
      } catch (error) {
        console.error('Erro ao calcular distância:', error);
        alert('Erro ao calcular distância: ' + error.message);
      }
    }

    async function excluirCandidatura(id) {
      if (!confirm('Tem certeza que deseja excluir esta candidatura? Esta ação não pode ser desfeita.')) {
        return;
      }

      try {
        await apiCall(`/api/admin/candidaturas/${id}`, { method: 'DELETE' });
        alert('Candidatura excluída com sucesso.');
        loadCurriculos(currentPage);
      } catch (error) {
        console.error('Erro ao excluir candidatura:', error);
        alert('Erro ao excluir candidatura: ' + error.message);
      }
    }

    // Fechar modais
    document.getElementById('close-modal').addEventListener('click', () => {
      document.getElementById('candidato-modal').style.display = 'none';
    });

    document.getElementById('close-vaga-modal').addEventListener('click', () => {
      document.getElementById('vaga-modal').style.display = 'none';
    });

    document.getElementById('close-distancia-modal').addEventListener('click', () => {
      document.getElementById('distancia-modal').style.display = 'none';
    });

    // Fechar modais ao clicar fora
    window.addEventListener('click', (e) => {
      if (e.target.classList.contains('modal')) {
        e.target.style.display = 'none';
      }
    });

    // ====== INICIALIZAÇÃO ======
    document.addEventListener('DOMContentLoaded', function() {
      // Carregar dashboard inicial
      loadDashboard();
    });
  </script>
</body>
</html>
